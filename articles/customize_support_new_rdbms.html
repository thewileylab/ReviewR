<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ReviewR">
<title>Support a New Relational Database Management System • ReviewR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Support a New Relational Database Management System">
<meta property="og:description" content="ReviewR">
<meta property="og:image" content="reviewr.thewileylab.org/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ReviewR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-deploying-reviewr">Deploying ReviewR</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-deploying-reviewr">
    <a class="dropdown-item" href="../articles/deploy_local.html">Local Deployment</a>
    <a class="dropdown-item" href="../articles/deploy_server.html">Shiny Server Deployment</a>
    <a class="dropdown-item" href="../articles/deploy_docker.html">Docker Deployment</a>
    <a class="dropdown-item" href="../articles/deploy_bigquery.html">Google BigQuery Deployment</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-using-reviewr">Using ReviewR</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-using-reviewr">
    <a class="dropdown-item" href="../articles/usage_connect_to_record_database.html">Connect to Patient Record Database</a>
    <a class="dropdown-item" href="../articles/usage_connect_to_redcap.html">Connect to REDCap</a>
    <a class="dropdown-item" href="../articles/usage_perform_chart_review.html">Perform A Chart Review</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-customizing-reviewr">Customizing ReviewR</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-customizing-reviewr">
    <a class="dropdown-item" href="../articles/customize_support_new_rdbms.html">Support a New Relational Database Management System</a>
    <a class="dropdown-item" href="../articles/customize_support_new_data_model.html">Support a Custom Data Model</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/thewileylab/ReviewR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Support a New Relational Database Management System</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/thewileylab/ReviewR/blob/HEAD/vignettes/customize_support_new_rdbms.Rmd" class="external-link"><code>vignettes/customize_support_new_rdbms.Rmd</code></a></small>
      <div class="d-none name"><code>customize_support_new_rdbms.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>ReviewR manages database connections with the help of the <a href="https://dbi.r-dbi.org/" class="external-link">DBI</a> and <a href="https://dbplyr.tidyverse.org/" class="external-link">dbplyr</a> packages from RStudio.
Leveraging these packages, ReviewR is able to operate on remote
databases as if they are local, in-memory data frames. R code written
with <a href="https://dplyr.tidyverse.org/" class="external-link">dplyr</a> verbs are
automatically translated to SQL by the dbplyr package and sent to the
connected database. The translation to the connected database is handled
by a DBI connection object, which references a database driver. A full
list of dplyr compatible database back-ends can be found <a href="https://db.rstudio.com/databases/" class="external-link">here</a>.</p>
<div class="section level3">
<h3 id="database-modules">Database Modules<a class="anchor" aria-label="anchor" href="#database-modules"></a>
</h3>
<p>ReviewR facilitates these DBI connections through the use of <a href="https://mastering-shiny.org/scaling-modules.html" class="external-link">Shiny
Modules</a>. Modules can make complex Shiny applications more
manageable. They compartmentalize code and are developed for a specific
purpose.</p>
<p>At their core, modules monitor user inputs that are defined in a User
Interface (UI) function, process these inputs in a server function, and
return an output. Each module operates in its own namespace, meaning
that Shiny modules are portable and can be used in other applications or
reused within the same application.</p>
<p>In ReviewR, this concept is used to create “database modules.” Each
patient database back-end will have different connection requirements,
meaning a new UI is needed to collect the required connection
information from the user. By modularizing this connection code, ReviewR
can support multiple databases so long as a correctly formatted DBI
connection object is returned to the ReviewR application. Thus “database
modules” are Shiny modules that are responsible for collecting
appropriate database credentials (IP address, port, etc.) and returning
a DBI connection object.</p>
<p>ReviewR dynamically switches between developed database modules with
its own database <em>setup</em> module. This setup module allows users
to interactively switch between database modules that have been
developed. When selected, each individual module’s UI will be presented
to guide the user through establishing a database connection.</p>
<p><img src="database_module.gif"><!-- --></p>
<p>Users can extend the functionality of ReviewR by adding developed
database modules to the “Database Module Setup” code chunk within
<code>R/mod_database_setup.R</code> as shown below:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Database Module Setup ----</span></span>
<span>      <span class="va">namespace</span> <span class="op">&lt;-</span> <span class="st">'db-selector-ns'</span></span>
<span>      <span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Add Database Setup Modules Here!!! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #</span></span>
<span>      <span class="co">## Add Database Setup Modules Here</span></span>
<span>      <span class="va">database_setup_vars</span> <span class="op">&lt;-</span> <span class="fu">reactiveValues</span><span class="op">(</span>bigquery <span class="op">=</span> <span class="fu"><a href="../reference/mod_bigquery.html">bigquery_setup_server</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">namespace</span> <span class="op">)</span>,</span>
<span>                                            postgresql <span class="op">=</span> <span class="fu"><a href="../reference/mod_postgres.html">postgresql_setup_server</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">namespace</span> <span class="op">)</span> <span class="co">#,</span></span>
<span>                                            <span class="co"># new_module = new_module_setup_server(id = namespace)</span></span>
<span>                                            <span class="op">)</span></span>
<span>      <span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #</span></span></code></pre></div>
<p>Once modules are added to the database setup, they will appear in the
Patient Database Module drop down on the setup tab.</p>
<p>Read on to learn how to develop a database module for ReviewR!</p>
</div>
</div>
<div class="section level2">
<h2 id="developing-a-database-module-for-reviewr">Developing a Database Module for ReviewR<a class="anchor" aria-label="anchor" href="#developing-a-database-module-for-reviewr"></a>
</h2>
<p>Creating a Shiny module is very similar to developing a stand alone
Shiny Application. When developing a database module for ReviewR, there
are a few differences that result because of its package architecture. A
<a href="#reviewr-database-module-template">template</a> has been
provided so that some aspects of ReviewR database module development can
be highlighted in the sections that follow.</p>
<p>If you are familiar with Shiny modules and want to begin developing
right away, you may skip ahead to the <a href="#start-developing">Start
Developing</a> Section of this guide.</p>
<div class="section level3">
<h3 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h3>
<p>The first step to developing a new ReviewR module will be to fork the
latest version of ReviewR from GitHub. Forking the repository will allow
you to experiment with the ReviewR package and ensures you have access
to the latest development tools and file structure of the ReviewR
package. For simplicity, the home directory is specified as a
destination directory:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages('usethis')</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/create_from_github.html" class="external-link">create_from_github</a></span><span class="op">(</span>repo_spec <span class="op">=</span> <span class="st">'thewileylab/ReviewR'</span>, destdir <span class="op">=</span> <span class="st">'~/'</span><span class="op">)</span></span></code></pre></div>
<p>Please see <a href="https://happygitwithr.com" class="external-link">this guide</a> if you
have trouble connecting RStudio with Git. It is also possible to fork
this repository directly from GitHub if all else fails.</p>
<p>Navigate to the forked repository and open the
<code>ReviewR.Rproj</code> file. This will open the project in RStudio.
Finally, using the devtools package run:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages('devtools')</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">load_all</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This will load the most recent version of ReviewR. At this point, you
are ready to begin developing a database module.</p>
</div>
<div class="section level3">
<h3 id="start-developing">Start Developing!<a class="anchor" aria-label="anchor" href="#start-developing"></a>
</h3>
<p>A helper function, <code>dev_database_module()</code>, has been
provided with ReviewR to help jump start the database module development
process. This function accepts 2 arguments:</p>
<ul>
<li>
<code>mod_name</code> - This is an internal variable that ReviewR
uses to keep track of the return values from the module, including the
DBI connection object.</li>
<li>
<code>display_name</code> - This variable will be the “choice” that
is presented to users on the Setup tab, so be sure it is descriptive and
recognizable!</li>
</ul>
<p>When ready, run:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ReviewR</span><span class="fu">:::</span><span class="fu">dev_database_module</span><span class="op">(</span>mod_name <span class="op">=</span> <span class="st">'your_module'</span>, display_name <span class="op">=</span> <span class="st">'Your Module Display Name'</span><span class="op">)</span></span></code></pre></div>
<p>This will create a module file in the <code>R/</code> directory of
the ReviewR package and open it for editing.</p>
</div>
<div class="section level3">
<h3 id="general-module-structure">General Module Structure<a class="anchor" aria-label="anchor" href="#general-module-structure"></a>
</h3>
<p>Take note of the <a href="#reviewr-database-module-template">ReviewR
Database Module Template</a>. It consists of 2 functions:</p>
<ul>
<li>{mod_name}_setup_ui - Defines the user interface that will guide
someone through the database connection process</li>
<li>{mod_name}_setup_server - Defines what actions to take as a result
of user inputs.</li>
</ul>
<p>ReviewR utilizes the <a href="https://shiny.posit.co/r/reference/shiny/1.5.0/moduleserver" class="external-link"><code>moduleServer()</code></a>
function introduced in Shiny 1.5. This allows the server portion of a
module to be called within your application just like any other
function, instead of relying on the previous <code><a href="https://rdrr.io/pkg/shiny/man/callModule.html" class="external-link">callModule()</a></code>
syntax.</p>
<p>The next thing to note is that ReviewR modules will ultimately become
a part of the ReviewR package namespace. This means that both the UI and
Server functions <em>require</em> roxygen comments, with all function
parameters, returns, and necessary package imports declared.</p>
<p>For additional information on module development, please see: <a href="https://shiny.posit.co/r/articles/improve/modules/" class="external-link uri">https://shiny.posit.co/r/articles/improve/modules/</a></p>
</div>
<div class="section level3">
<h3 id="requirements">Requirements<a class="anchor" aria-label="anchor" href="#requirements"></a>
</h3>
<ul>
<li>a UI function defined as <code>{module_name}_setup_ui</code> that
accepts a single parameter (id)</li>
<li>a server function defined as <code>{module_name}_setup_server</code>
with a <code><a href="https://rdrr.io/pkg/shiny/man/reactiveValues.html" class="external-link">reactiveValues()</a></code> return
<ul>
<li>reactiveValues must contain the following variables, with these
initial values set:
<ul>
<li>moduleName = ‘{Your Database Module Name}’</li>
<li>moduleType = ‘database’</li>
<li>setup_ui = ReviewR::{module_name}_setup_ui</li>
<li>is_connected = ‘no’</li>
<li>db_con = NULL</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="section level4">
<h4 id="ui-function">UI Function<a class="anchor" aria-label="anchor" href="#ui-function"></a>
</h4>
<p>Begin by adding <a href="https://shiny.posit.co/r/gallery/widgets/widget-gallery/" class="external-link">Shiny
Widgets</a> to the <code><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList()</a></code> portion of the UI function in
your database module. Users will interact with these widgets to enter
their database credentials. Consider adding a “Connect” and “Disconnect”
button to your UI which can be monitored by your server function to
store the user entered credentials and combine them into a DBI
connection object. Specifics will vary by database. Remember to wrap all
user inputID’s with the <code>ns()</code> function, so that they will
inherit the module namespace.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tagList</span><span class="op">(</span></span>
<span>  <span class="fu">actionButton</span><span class="op">(</span>inputId <span class="op">=</span> <span class="fu">ns</span><span class="op">(</span><span class="st">'connect'</span><span class="op">)</span>,label <span class="op">=</span> <span class="st">'connect'</span><span class="op">)</span>,</span>
<span>  <span class="fu">actionButton</span><span class="op">(</span>inputId <span class="op">=</span> <span class="fu">ns</span><span class="op">(</span><span class="st">'disconnect'</span><span class="op">)</span>,label <span class="op">=</span> <span class="st">'disconnect'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="example-connect-server-logic">Example ‘Connect’ Server Logic<a class="anchor" aria-label="anchor" href="#example-connect-server-logic"></a>
</h4>
<p>As mentioned previously, the entire goal of a ReviewR database module
is to construct a DBI connection object with user entered information.
This DBI connection object needs to be assigned to the
<code>db_con</code> reactive values object, say when a user clicks a
button labeled ‘connect’. However, this user entered information should
be validated. Consider the following pseudo code:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="co">## Observe a connect button, defined in the UI function</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">connect</span>, <span class="op">{</span></span>
<span>  <span class="co">## When the button is pressed, store a temporary connection</span></span>
<span>  <span class="va">temp_con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span>drv <span class="op">=</span> <span class="fu">database_driver</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                             user <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">username</span>, <span class="co">## A text input, with a username</span></span>
<span>                             pass <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">password</span> <span class="co">## A password input</span></span>
<span>                             <span class="op">)</span></span>
<span>  <span class="co">## Design a test to validate the temporary connection object</span></span>
<span>  <span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu">connection_test</span><span class="op">(</span><span class="va">temp_con</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## If the test passes, update the reactiveValues objects for the `is_connected` and `db_con` variables</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">test_result</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">database_export</span><span class="op">$</span><span class="va">is_connected</span> <span class="op">&lt;-</span> <span class="st">'yes'</span></span>
<span>    <span class="va">database_export</span><span class="op">$</span><span class="va">db_con</span> <span class="op">&lt;-</span> <span class="va">temp_con</span></span>
<span>    <span class="co">## Else, don't create connection info</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">database_export</span><span class="op">$</span><span class="va">is_connected</span> <span class="op">&lt;-</span> <span class="st">'no'</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">## Let ReviewR handle the rest!</span></span></code></pre></div>
<p>The database setup module in ReviewR is ‘observing’ the return of the
currently selected database module. When the <code>is_connected</code>
variable changes to ‘yes’, it knows that <em>valid</em> connection
information is present, and it can begin working with the connected
database.</p>
</div>
<div class="section level4">
<h4 id="example-disconnect-server-logic">Example ‘Disconnect’ Server Logic<a class="anchor" aria-label="anchor" href="#example-disconnect-server-logic"></a>
</h4>
<p>Database modules are also responsible for clearing connection
information when a user wants to disconnect. Here is a simple example of
a database disconnect where a user presses a ‘disconnect’ button:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Observe a connect button, defined in the UI function</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">observeEvent</span>(input<span class="sc">$</span>disconnect, (</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Tell the database you are disconnecting</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  DBI<span class="sc">::</span><span class="fu">dbDisconnect</span>(database_export<span class="sc">$</span>db_con)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Clear the connection info</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  database_export<span class="sc">$</span>db_con <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Set `is_connected` variable back to 'no'</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  database_export<span class="sc">$</span>is_connected <span class="ot">&lt;-</span> <span class="st">'no'</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>))</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="other-considerations">Other Considerations<a class="anchor" aria-label="anchor" href="#other-considerations"></a>
</h4>
<p>Think about how users will be interacting with this module. When a
button is clicked, how will they notice that changes are being
processed? Will an error message be displayed if incorrect credentials
are entered? When connected, will a “connection success” message be
presented?</p>
</div>
<div class="section level4">
<h4 id="important">Important<a class="anchor" aria-label="anchor" href="#important"></a>
</h4>
<p>As you are developing/testing, remember to add your completed
<code>setup_server</code> function to
<code>R/mod_database_setup.R</code>. This is required to have the module
display within ReviewR. When incorporated into ReviewR, the
<code>moduleName</code> parameter of the database module’s
reactiveValues will be what appears in the Database Module Selector drop
down list. Once you are sure you have added your module to
<code>mod_database_setup.R</code> and you are ready to test, run:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">golem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/golem/man/document_and_reload.html" class="external-link">document_and_reload</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This will incorporate your newly developed module into the ReviewR
namespace, allowing you to see any changes that you have made as a
result of your development process.</p>
</div>
</div>
<div class="section level3">
<h3 id="finishing-up">Finishing up<a class="anchor" aria-label="anchor" href="#finishing-up"></a>
</h3>
<p>Once you are satisfied with your module and have sufficiently tested
its functionality, run:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This will install a new, custom version of the ReviewR package with
your newly developed module incorporated.</p>
</div>
<div class="section level3">
<h3 id="reviewr-database-module-template">ReviewR Database Module Template<a class="anchor" aria-label="anchor" href="#reviewr-database-module-template"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UI ----</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' {display_name} Setup UI</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' This module is designed to guide a user through the process of authenticating your database</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param id The module namespace</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return The {display_name} Setup UI</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#' @importFrom shiny NS</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>{mod_name}_setup_ui <span class="ot">&lt;-</span> <span class="cf">function</span>(id) { </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  ns <span class="ot">&lt;-</span> <span class="fu">NS</span>(id)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tagList</span>(</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## UI widgets here ----</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Server ----</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">#' {display_name} Setup Server</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param id The Module namespace</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return {display_name} connection variables</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#' @export</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#' @importFrom DBI dbConnect</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>{mod_name}_setup_server <span class="ot">&lt;-</span> <span class="cf">function</span>(id) {</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">moduleServer</span>(</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    id,</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(input, output, session) {</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>      ns <span class="ot">&lt;-</span> session<span class="sc">$</span>ns</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>      <span class="do">## {mod_name} Export Values ----</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>      {mod_name}_export <span class="ot">&lt;-</span> <span class="fu">reactiveValues</span>(</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>        <span class="do">### Module Info</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">moduleName =</span> <span class="st">'{display_name}'</span>,</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">moduleType =</span> <span class="st">'database'</span>,</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">setup_ui =</span> ReviewR<span class="sc">::</span>{mod_name}_setup_ui,</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">is_connected =</span> <span class="st">'no'</span>,       </span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">db_con =</span> <span class="cn">NULL</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Server Code Here ----</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Return ----</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>({mod_name}_export)</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Laura Wiley, Luke Rasmussen, David Mayer, <a href="https://www.thewileylab.org/" class="external-link"><img src="https://raw.githubusercontent.com/thewileylab/ReviewR/master/man/figures/WileyLab.svg" height="24"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
