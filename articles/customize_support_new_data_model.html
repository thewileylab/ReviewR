<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ReviewR">
<title>Support a New Data Model • ReviewR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Support a New Data Model">
<meta property="og:description" content="ReviewR">
<meta property="og:image" content="reviewr.thewileylab.org/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ReviewR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.10</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-deploying-reviewr">Deploying ReviewR</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-deploying-reviewr">
    <a class="dropdown-item" href="../articles/deploy_local.html">Local Deployment</a>
    <a class="dropdown-item" href="../articles/deploy_server.html">Shiny Server Deployment</a>
    <a class="dropdown-item" href="../articles/deploy_docker.html">Docker Deployment</a>
    <a class="dropdown-item" href="../articles/deploy_bigquery.html">Google BigQuery Deployment</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-using-reviewr">Using ReviewR</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-using-reviewr">
    <a class="dropdown-item" href="../articles/usage_connect_to_record_database.html">Connect to Patient Record Database</a>
    <a class="dropdown-item" href="../articles/usage_connect_to_redcap.html">Connect to REDCap</a>
    <a class="dropdown-item" href="../articles/usage_perform_chart_review.html">Perform A Chart Review</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-customizing-reviewr">Customizing ReviewR</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-customizing-reviewr">
    <a class="dropdown-item" href="../articles/customize_support_new_rdbms.html">Support a New Relational Database Management System</a>
    <a class="dropdown-item" href="../articles/customize_support_new_data_model.html">Support a Custom Data Model</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/thewileylab/ReviewR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="customize_support_new_data_model_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="customize_support_new_data_model_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="customize_support_new_data_model_files/datatables-binding-0.29/datatables.js"></script><link href="customize_support_new_data_model_files/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="customize_support_new_data_model_files/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="customize_support_new_data_model_files/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><link href="customize_support_new_data_model_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="customize_support_new_data_model_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Support a New Data Model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/thewileylab/ReviewR/blob/HEAD/vignettes/customize_support_new_data_model.Rmd" class="external-link"><code>vignettes/customize_support_new_data_model.Rmd</code></a></small>
      <div class="d-none name"><code>customize_support_new_data_model.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Currently, ReviewR is capable of displaying patient information from
databases that conform to the MIMIC-III and OMOP data models. However,
we recognize that clinical data can be stored in a variety of different
formats. Accordingly, ReviewR can be extended to display patient data
for additional data models. This vignette is organized into two main
sections focused on the mechanics of data model support in ReviewR and
how to add support for new data models:</p>
<ul>
<li>
<a href="#reviewr-data-model-support">ReviewR Data Model Support</a>
- Describes how different data models are supported by ReviewR</li>
<li>
<a href="#adding-support-for-a-new-data-model">Adding Support for a
New Data Model</a> - How to add support for a new data model to
ReviewR</li>
</ul>
</div>
<div class="section level2">
<h2 id="reviewr-data-model-support">ReviewR Data Model Support<a class="anchor" aria-label="anchor" href="#reviewr-data-model-support"></a>
</h2>
<p>A data model defines the tables and fields that are contained within
a database. These definitions are typically described in a schema file,
which provides a full listing of the tables and fields contained within
a database. ReviewR uses the definitions stored in a data model schema
file to select an appropriate set of internal ReviewR functions to
display the patient information that is presented on the “Chart Review”
tab. In ReviewR, these functions are referred to as “<em>table
functions</em>,” as they are responsible for querying, formatting,
downloading and ultimately displaying patient information from the
tables in your connected clinical database. These special functions are
dynamically selected based on the data model that is detected when
connecting.</p>
<p>In order for ReviewR to display patient data stored in <em>other</em>
data models, support must be added. Developing support for additional
data models requires some understanding of two ReviewR’s mechanics:</p>
<ol style="list-style-type: decimal">
<li>
<a href="#data-model-detection">Data Model Detection</a>: ReviewR
must be able to detect the patient data model of the connected database.
<ul>
<li>A schema file <em>is required</em> to add support for custom data
models. Schema files must be CSV formatted and contain two columns:
<em>table</em> and <em>field</em>. These columns must contain a pairwise
combination of every table and field in the target data model.</li>
</ul>
</li>
<li>
<a href="#data-model-display">Data Model Display</a>: ReviewR
requires a set of “table functions” specific to a detected data model to
define every aspect of how the patient data is displayed.
<ul>
<li>Table functions must follow the <a href="#table-function-naming-convention">table function naming
convention</a>.</li>
</ul>
</li>
</ol>
<p>These components will be discussed in the sections that follow.</p>
<div class="section level3">
<h3 id="data-model-detection">Data Model Detection<a class="anchor" aria-label="anchor" href="#data-model-detection"></a>
</h3>
<p>When a database connection is established, ReviewR will use the
connection information supplied from the database connection module to
interrogate the connected database and attempt to determine the data
model and data model version. ReviewR accomplishes this task by
discovering the table and field names of the connected database and
comparing them with data model specifications that have been built into
the ReviewR package. The built in data model that has the most matching
table/field combinations to the connected database will be identified as
the currently connected data model.</p>
<p>If data model detection is successful, ReviewR will select the
appropriate table functions that have been built into the package that
correspond to the detected data model to display the information stored
in the database tables. Additionally, ReviewR calculates an internal
variable, called <em>table_map</em> which will be used to map the table
and field combinations in the connected database back to corresponding
table and fields of the detected data model specification. This allows
for case insensitive matching between between the data model
specification and the connected database.</p>
<p>If however, ReviewR fails to identify enough table and field matches
to data models with existing ReviewR support, data model detection will
fail, and ReviewR will be unable to display patient information from
your connected database. An error message will be presented upon
connection, notifying you of this.</p>
<p>To see a list of currently supported database specifications in
ReviewR, run:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://reviewr.thewileylab.org/">ReviewR</a></span><span class="op">)</span></span>
<span><span class="fu">ReviewR</span><span class="fu">::</span><span class="va"><a href="../reference/supported_data_models.html">supported_data_models</a></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   file_path, data_model, model_version [12]</span></span></span>
<span><span class="co">#&gt;    data_model model_version data               file_path                        </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> mimic3     <span style="color: #949494;">"</span>v1.4<span style="color: #949494;">"</span>        <span style="color: #949494;">&lt;tibble [332 × 8]&gt;</span> data-raw/data_models/mimic3_v1.4…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> mimic3     <span style="color: #949494;">""</span>            <span style="color: #949494;">&lt;tibble [333 × 8]&gt;</span> data-raw/data_models/mimic3.csv  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> omop       <span style="color: #949494;">"</span>v4<span style="color: #949494;">"</span>          <span style="color: #949494;">&lt;tibble [49 × 8]&gt;</span>  data-raw/data_models/omop_v4.csv </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> omop       <span style="color: #949494;">"</span>v5.0.1<span style="color: #949494;">"</span>      <span style="color: #949494;">&lt;tibble [328 × 8]&gt;</span> data-raw/data_models/omop_v5.0.1…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> omop       <span style="color: #949494;">"</span>v5.1.0<span style="color: #949494;">"</span>      <span style="color: #949494;">&lt;tibble [339 × 8]&gt;</span> data-raw/data_models/omop_v5.1.0…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> omop       <span style="color: #949494;">"</span>v5.1.1<span style="color: #949494;">"</span>      <span style="color: #949494;">&lt;tibble [339 × 8]&gt;</span> data-raw/data_models/omop_v5.1.1…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> omop       <span style="color: #949494;">"</span>v5.2<span style="color: #949494;">"</span>        <span style="color: #949494;">&lt;tibble [365 × 8]&gt;</span> data-raw/data_models/omop_v5.2_b…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> omop       <span style="color: #949494;">"</span>v5.2.0<span style="color: #949494;">"</span>      <span style="color: #949494;">&lt;tibble [334 × 8]&gt;</span> data-raw/data_models/omop_v5.2.0…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> omop       <span style="color: #949494;">"</span>v5.2.2<span style="color: #949494;">"</span>      <span style="color: #949494;">&lt;tibble [363 × 8]&gt;</span> data-raw/data_models/omop_v5.2.2…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> omop       <span style="color: #949494;">"</span>v5.3.0<span style="color: #949494;">"</span>      <span style="color: #949494;">&lt;tibble [407 × 8]&gt;</span> data-raw/data_models/omop_v5.3.0…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> omop       <span style="color: #949494;">"</span>v5.3.1<span style="color: #949494;">"</span>      <span style="color: #949494;">&lt;tibble [407 × 8]&gt;</span> data-raw/data_models/omop_v5.3.1…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> omop       <span style="color: #949494;">"</span>v6.0<span style="color: #949494;">"</span>        <span style="color: #949494;">&lt;tibble [427 × 8]&gt;</span> data-raw/data_models/omop_v6.0.c…</span></span></code></pre></div>
<p>A data frame with 4 columns will be returned:</p>
<ul>
<li>data_model: The data model name</li>
<li>model_version: The data model version</li>
<li>data: A nested data frame with the schema of the data model itself
<ul>
<li>This schema information comes from CSV files that may be built into
the ReviewR package</li>
</ul>
</li>
<li>file_path: The file path<a href="#file-path">*</a> of the data
source</li>
</ul>
<p><a name="file-path"></a> *<em>Note: The data-raw file path is only
available when forking the ReviewR repository from GitHub.</em></p>
<div class="section level4">
<h4 id="schema-files">Schema Files<a class="anchor" aria-label="anchor" href="#schema-files"></a>
</h4>
<p>Data model specifications are provided by schema files which are
comma separated values (CSV) formatted files that contain at least two
columns, <code>table</code> and <code>field</code>, which identify every
field for every table in the data model. If you are using a common data
model, they may be available from the consortium that define the data
model standards. If obtained from a developer, these files may include
additional information beyond the required table and field designations.
These files may still be used, but additional descriptors will be
ignored. The schema file for the OMOP CDM v5.3.0 is provided as an
example:</p>
<div class="figure" style="text-align: center">
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-fc8d669b4b246b2f3440" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-fc8d669b4b246b2f3440">{"x":{"filter":"none","vertical":false,"data":[["concept","concept","concept","concept","concept","concept","concept","concept","concept","concept","vocabulary","vocabulary","vocabulary","vocabulary","vocabulary","domain","domain","domain","concept_class","concept_class","concept_class","concept_relationship","concept_relationship","concept_relationship","concept_relationship","concept_relationship","concept_relationship","relationship","relationship","relationship","relationship","relationship","relationship","concept_synonym","concept_synonym","concept_synonym","concept_ancestor","concept_ancestor","concept_ancestor","concept_ancestor","source_to_concept_map","source_to_concept_map","source_to_concept_map","source_to_concept_map","source_to_concept_map","source_to_concept_map","source_to_concept_map","source_to_concept_map","source_to_concept_map","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","drug_strength","cohort_definition","cohort_definition","cohort_definition","cohort_definition","cohort_definition","cohort_definition","cohort_definition","attribute_definition","attribute_definition","attribute_definition","attribute_definition","attribute_definition","cdm_source","cdm_source","cdm_source","cdm_source","cdm_source","cdm_source","cdm_source","cdm_source","cdm_source","cdm_source","metadata","metadata","metadata","metadata","metadata","metadata","metadata","person","person","person","person","person","person","person","person","person","person","person","person","person","person","person","person","person","person","observation_period","observation_period","observation_period","observation_period","observation_period","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","specimen","death","death","death","death","death","death","death","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_occurrence","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","visit_detail","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","procedure_occurrence","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","drug_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","device_exposure","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","condition_occurrence","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","measurement","note","note","note","note","note","note","note","note","note","note","note","note","note","note","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","note_nlp","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","observation","fact_relationship","fact_relationship","fact_relationship","fact_relationship","fact_relationship","location","location","location","location","location","location","location","location","care_site","care_site","care_site","care_site","care_site","care_site","provider","provider","provider","provider","provider","provider","provider","provider","provider","provider","provider","provider","provider","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","payer_plan_period","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cost","cohort","cohort","cohort","cohort","cohort_attribute","cohort_attribute","cohort_attribute","cohort_attribute","cohort_attribute","cohort_attribute","cohort_attribute","drug_era","drug_era","drug_era","drug_era","drug_era","drug_era","drug_era","dose_era","dose_era","dose_era","dose_era","dose_era","dose_era","dose_era","condition_era","condition_era","condition_era","condition_era","condition_era","condition_era"],["concept_id","concept_name","domain_id","vocabulary_id","concept_class_id","standard_concept","concept_code","valid_start_date","valid_end_date","invalid_reason","vocabulary_id","vocabulary_name","vocabulary_reference","vocabulary_version","vocabulary_concept_id","domain_id","domain_name","domain_concept_id","concept_class_id","concept_class_name","concept_class_concept_id","concept_id_1","concept_id_2","relationship_id","valid_start_date","valid_end_date","invalid_reason","relationship_id","relationship_name","is_hierarchical","defines_ancestry","reverse_relationship_id","relationship_concept_id","concept_id","concept_synonym_name","language_concept_id","ancestor_concept_id","descendant_concept_id","min_levels_of_separation","max_levels_of_separation","source_code","source_concept_id","source_vocabulary_id","source_code_description","target_concept_id","target_vocabulary_id","valid_start_date","valid_end_date","invalid_reason","drug_concept_id","ingredient_concept_id","amount_value","amount_unit_concept_id","numerator_value","numerator_unit_concept_id","denominator_value","denominator_unit_concept_id","box_size","valid_start_date","valid_end_date","invalid_reason","cohort_definition_id","cohort_definition_name","cohort_definition_description","definition_type_concept_id","cohort_definition_syntax","subject_concept_id","cohort_initiation_date","attribute_definition_id","attribute_name","attribute_description","attribute_type_concept_id","attribute_syntax","cdm_source_name","cdm_source_abbreviation","cdm_holder","source_description","source_documentation_reference","cdm_etl_reference","source_release_date","cdm_release_date","cdm_version","vocabulary_version","metadata_concept_id","metadata_type_concept_id","name","value_as_string","value_as_concept_id","metadata_date","metadata_datetime","person_id","gender_concept_id","year_of_birth","month_of_birth","day_of_birth","birth_datetime","race_concept_id","ethnicity_concept_id","location_id","provider_id","care_site_id","person_source_value","gender_source_value","gender_source_concept_id","race_source_value","race_source_concept_id","ethnicity_source_value","ethnicity_source_concept_id","observation_period_id","person_id","observation_period_start_date","observation_period_end_date","period_type_concept_id","specimen_id","person_id","specimen_concept_id","specimen_type_concept_id","specimen_date","specimen_datetime","quantity","unit_concept_id","anatomic_site_concept_id","disease_status_concept_id","specimen_source_id","specimen_source_value","unit_source_value","anatomic_site_source_value","disease_status_source_value","person_id","death_date","death_datetime","death_type_concept_id","cause_concept_id","cause_source_value","cause_source_concept_id","visit_occurrence_id","person_id","visit_concept_id","visit_start_date","visit_start_datetime","visit_end_date","visit_end_datetime","visit_type_concept_id","provider_id","care_site_id","visit_source_value","visit_source_concept_id","admitting_source_concept_id","admitting_source_value","discharge_to_concept_id","discharge_to_source_value","preceding_visit_occurrence_id","visit_detail_id","person_id","visit_detail_concept_id","visit_start_date","visit_start_datetime","visit_end_date","visit_end_datetime","visit_type_concept_id","provider_id","care_site_id","admitting_source_concept_id","discharge_to_concept_id","preceding_visit_detail_id","visit_source_value","visit_source_concept_id","admitting_source_value","discharge_to_source_value","visit_detail_parent_id","visit_occurrence_id","procedure_occurrence_id","person_id","procedure_concept_id","procedure_date","procedure_datetime","procedure_type_concept_id","modifier_concept_id","quantity","provider_id","visit_occurrence_id","visit_detail_id","procedure_source_value","procedure_source_concept_id","modifier_source_value","drug_exposure_id","person_id","drug_concept_id","drug_exposure_start_date","drug_exposure_start_datetime","drug_exposure_end_date","drug_exposure_end_datetime","verbatim_end_date","drug_type_concept_id","stop_reason","refills","quantity","days_supply","sig","route_concept_id","lot_number","provider_id","visit_occurrence_id","visit_detail_id","drug_source_value","drug_source_concept_id","route_source_value","dose_unit_source_value","device_exposure_id","person_id","device_concept_id","device_exposure_start_date","device_exposure_start_datetime","device_exposure_end_date","device_exposure_end_datetime","device_type_concept_id","unique_device_id","quantity","provider_id","visit_occurrence_id","visit_detail_id","device_source_value","device_source_concept_id","condition_occurrence_id","person_id","condition_concept_id","condition_start_date","condition_start_datetime","condition_end_date","condition_end_datetime","condition_type_concept_id","stop_reason","provider_id","visit_occurrence_id","visit_detail_id","condition_source_value","condition_source_concept_id","condition_status_source_value","condition_status_concept_id","measurement_id","person_id","measurement_concept_id","measurement_date","measurement_time","measurement_datetime","measurement_type_concept_id","operator_concept_id","value_as_number","value_as_concept_id","unit_concept_id","range_low","range_high","provider_id","visit_occurrence_id","visit_detail_id","measurement_source_value","measurement_source_concept_id","unit_source_value","value_source_value","note_id","person_id","note_date","note_datetime","note_type_concept_id","note_class_concept_id","note_title","note_text","encoding_concept_id","language_concept_id","provider_id","visit_occurrence_id","visit_detail_id","note_source_value","note_nlp_id","note_id","section_concept_id","snippet","offset","lexical_variant","note_nlp_concept_id","note_nlp_source_concept_id","nlp_system","nlp_date","nlp_datetime","term_exists","term_temporal","term_modifiers","observation_id","person_id","observation_concept_id","observation_date","observation_datetime","observation_type_concept_id","value_as_number","value_as_string","value_as_concept_id","qualifier_concept_id","unit_concept_id","provider_id","visit_occurrence_id","visit_detail_id","observation_source_value","observation_source_concept_id","unit_source_value","qualifier_source_value","domain_concept_id_1","fact_id_1","domain_concept_id_2","fact_id_2","relationship_concept_id","location_id","address_1","address_2","city","state","zip","county","location_source_value","care_site_id","care_site_name","place_of_service_concept_id","location_id","care_site_source_value","place_of_service_source_value","provider_id","provider_name","npi","dea","specialty_concept_id","care_site_id","year_of_birth","gender_concept_id","provider_source_value","specialty_source_value","specialty_source_concept_id","gender_source_value","gender_source_concept_id","payer_plan_period_id","person_id","payer_plan_period_start_date","payer_plan_period_end_date","payer_concept_id","payer_source_value","payer_source_concept_id","plan_concept_id","plan_source_value","plan_source_concept_id","sponsor_concept_id","sponsor_source_value","sponsor_source_concept_id","family_source_value","stop_reason_concept_id","stop_reason_source_value","stop_reason_source_concept_id","cost_id","cost_event_id","cost_domain_id","cost_type_concept_id","currency_concept_id","total_charge","total_cost","total_paid","paid_by_payer","paid_by_patient","paid_patient_copay","paid_patient_coinsurance","paid_patient_deductible","paid_by_primary","paid_ingredient_cost","paid_dispensing_fee","payer_plan_period_id","amount_allowed","revenue_code_concept_id","reveue_code_source_value","drg_concept_id","drg_source_value","cohort_definition_id","subject_id","cohort_start_date","cohort_end_date","cohort_definition_id","subject_id","cohort_start_date","cohort_end_date","attribute_definition_id","value_as_number","value_as_concept_id","drug_era_id","person_id","drug_concept_id","drug_era_start_date","drug_era_end_date","drug_exposure_count","gap_days","dose_era_id","person_id","drug_concept_id","unit_concept_id","dose_value","dose_era_start_date","dose_era_end_date","condition_era_id","person_id","condition_concept_id","condition_era_start_date","condition_era_end_date","condition_occurrence_count"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>table<\/th>\n      <th>field<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script><p class="caption">
<em>Table 1: OMOP v5.3.0 Schema obtained from <a href="https://github.com/OHDSI/CommonDataModel/releases/tag/v5.3.0" class="external-link">OHDSI</a></em>
</p>
</div>
<p>Files such as these can be built into the ReviewR package, so that it
may identify additional data models and display the corresponding
patient information.</p>
</div>
</div>
<div class="section level3">
<h3 id="data-model-display">Data Model Display<a class="anchor" aria-label="anchor" href="#data-model-display"></a>
</h3>
<p>Displaying patient data from other data models is made possible by
developing “<em>table functions</em>” which are incorporated into the
ReviewR package namespace. Functions provide a convenient way to code
table representations, as they can accept data model and connection info
from ReviewR as variables. Additionally all of the necessary code
required to display your data model tables exists in one place easily
modifiable place. Writing functions is hard! Writing <em>good</em>
functions takes <em>a lot</em> of practice. <em>Do not</em> use the
ReviewR code base as a guide for <em>good</em> function writing.
Instead, take a look at <a href="https://r4ds.had.co.nz/functions.html" class="external-link uri">https://r4ds.had.co.nz/functions.html</a> for information on
how to write good functions.</p>
<div class="figure" style="text-align: center">
<img src="chart_review_tabs.png" alt='*Patient information tabsets on the "Chart Review" tab of ReviewR are generated by table functions.*'><p class="caption">
<em>Patient information tabsets on the “Chart Review” tab of ReviewR are
generated by table functions.</em>
</p>
</div>
<p>Once ReviewR has determined data model and version of the user
database, it will search for appropriately named functions that can be
used to download and display the information contained within the
connected data model. These table functions <em>must</em> be named
according to a specific naming convention.</p>
<p>Two convenience functions have been included with ReviewR to assist
in developing the required table functions for your data model:
<code>user_table</code> and <code>user_field</code>. These functions
allow for table functions to be coded by requesting the desired table
name from the schema file. ReviewR then performs case insensitive
matching to the appropriate table/field in the user’s connected data
using the <em>table_map</em> variable as discussed previously.</p>
<p>When developing table functions for ReviewR, there are two different
types of table functions that must be considered. The first, is the
table function that will be responsible for generating the information
on the “Patient Search” tab, which contains demographic information for
<em>every</em> patient in the database. In ReviewR terminology, this is
referred to as the “All Patients” <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The “All Patients’ table function will be used to render
the patients displayed in the ‘Patient Search’ Section of ReviewR and
must use the following naming convention:
&lt;code&gt;{data-model-name}_table_all_patients&lt;/code&gt;&lt;/p&gt;"><sup>1</sup></a> table.</p>
<p>For example, in the OMOP data model, demographic information is
contained within the “person” table. An “All Patients” table function
that could be used to display this information on the “Patient Search”
tab could take the following form:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">omop_table_all_patients</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table_map</span>, <span class="va">db_connection</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/user_table.html">user_table</a></span><span class="op">(</span><span class="va">table_map</span>, <span class="va">db_connection</span>, <span class="st">'person'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>ID <span class="op">=</span> <span class="fu"><a href="../reference/user_field.html">user_field</a></span><span class="op">(</span><span class="va">table_map</span>, <span class="st">'person'</span>, <span class="st">'person_id'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">collect</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The above will retrieve the “person” table in the user connected
database, using the <em>table_map</em> and <em>db_connection</em>
variables to locate the correct table and securely access the database,
respectively. These variables are supplied by ReviewR and should be used
as arguments to this function. Additionally, the column containing your
data model’s subject id (record id, patient id, person id, Medical
Record Number, etc.) must be renamed to ‘ID’. In the OMOP data model,
this field is coded as ‘person_id’. Using the <code>user_field</code>
function, we can locate the field of interest in our connected data by
supplying the function with: the <em>table_map</em> variable, the table
we know the field to exist in, and the field we’d like to retrieve. We
can then transform this column name to ID using the <code>mutate</code>
function. This informs ReviewR that when a user selects this ID column,
all information on the “Chart Review” Tab will need to be filtered to
the identifier selected from this column.</p>
<p>The second type of table function will be responsible for displaying
the clinical data as depicted on the “Chart Review” tab. In most
clinical data models, any given table will contain a particular type of
patient information for <em>every</em> patient in the data set. Thus,
information in these tables must be filtered down to a singular subject,
usually by a numeric identifier. In addition to the <em>table_map</em>
and <em>db_connection</em> variables, these “Subject Specific” <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;“Subject Specific” tables will make up the tabsets that
appear in the “Chart Review” tab of ReviewR. The function will then
extract the information for the selected patient and each tabset
displayed in ReviewR will only contain information from the subject that
has been selected in the Patient Search Section. These functions follow
following naming
convention:&lt;code&gt;{data-model-name}_table_{table-name}&lt;/code&gt;&lt;/p&gt;"><sup>2</sup></a> table
functions must accept an additional <em>subject_id</em> argument:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">omop_table_condition_occurrence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table_map</span>, <span class="va">db_connection</span>, <span class="va">subject_id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/user_table.html">user_table</a></span><span class="op">(</span><span class="va">table_map</span>, <span class="va">db_connection</span>, <span class="st">'person'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ID</span> <span class="op">==</span> <span class="va">subject_id</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">collect</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This function will retrieve the “condition occurrence” table from the
connected database, filtered to contain only the conditions that pertain
to the selected subject.</p>
<div class="section level4">
<h4 id="table-function-naming-convention">Table Function Naming Convention<a class="anchor" aria-label="anchor" href="#table-function-naming-convention"></a>
</h4>
<p>Table functions have a standard naming convention, which allows for
them to be associated with the currently detected data model. Functions
used to render patient tables must have the following format:
<code>{data-model-name}_table_{table-name}</code>. They start with the
name of the data model (no spaces, dashes, or underscores are allowed,
though CamelCase is acceptable) followed by “_table” and then end with
the <em>name</em> of the table you would like to display (long table
names may include underscores). This last bit of the function name will
become the label of the tabset on the “Chart Review” tab in ReviewR.
When developing table functions for a particular data model, there must
be exactly 1 function that codes for the “All Patients” table (function
name ending in ’_all_patients’) and any number of additional “Subject
Specific” table functions.</p>
<p>As an example, say you would like to add support for the <a href="https://pcornet.org/data-driven-common-model/" class="external-link">PCORnet data
model</a> to ReviewR. After you have added a schema file for the PCORnet
version that you would like to support, you will have to create an “all
patients” table function and 1 or more “subject specific” table
functions. In PCORnet, patient demographic information is stored in the
“DEMOGRAPHICS” table, but this is irrelevant for the <em>function
name</em> that will ultimately connect to this table. The appropriate
<em>name</em> for the “all patients” table function would be:
<code>PCORnet_table_all_patients</code>. This function will contain code
that connects to the “DEMOGRAPHICS” table, and will be used to display
the patient list on the “Patient Search” tab of ReviewR.</p>
<p>Additional “subject specific” table functions will need to be created
to display information on the “Chart Review” tab of ReviewR. For
example, an appropriate name for the “ENCOUNTER” table function would
be: <code>PCORnet_table_ENCOUNTER</code>. This would add a tabset to the
“Chart Review” tab of ReviewR with the label “Encounter.”</p>
<p>This naming convention ensures that when ReviewR detects that a
PCORnet database is connected, all functions beginning with
<code>PCORnet_table_</code> will be available to display the patient
information. Once table functions have been created for a data model,
all functions that have been developed will displayed as tabs in the
Chart Review section of ReviewR when the new data model is detected.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="adding-support-for-a-new-data-model">Adding Support for a New Data Model<a class="anchor" aria-label="anchor" href="#adding-support-for-a-new-data-model"></a>
</h2>
<p>ReviewR has been developed as a package utilizing the <a href="https://thinkr-open.github.io/golem/" class="external-link">golem</a> framework.
Essentially, this means that the Shiny application is organized in such
a way that all major application features are provided by functions.
These functions are disambiguated from other functions in your R package
library because they exported with the ReviewR package’s namespace. This
also helps ReviewR to access the functionality of other packages through
namespace imports.</p>
<p>The advantages to this approach include ease of distribution,
providing inline application documentation, and providing a reasonable
expectation of installation/deployment success across different
operating systems and server environments. To learn more about package
namespaces, please see: <a href="https://r-pkgs.org/namespace.html" class="external-link uri">https://r-pkgs.org/namespace.html</a></p>
<p>This does however introduce some additional caveats to the
development process. The main caveat to be aware of when developing for
ReviewR is that any changes made to ReviewR’s code will not immediately
be reflected the next time the application is launched. The reasons for
this are fairly technical, but the root of the issue is that new changes
must be explicitly added to the package namespace. Golem provides a
function that will both update any necessary documentation and load all
of the development changes since the last save into the active R
session, so that new changes to the code can be tested without having to
rebuild and install each time a change is made. After making code
modifications, simply run <code><a href="https://rdrr.io/pkg/golem/man/document_and_reload.html" class="external-link">golem::document_and_reload()</a></code> to
make the new changes available the next time the application is
launched.</p>
<p>For additional information about developing an R Shiny application
with <code>golem</code>, please see: <a href="https://engineering-shiny.org/index.html" class="external-link uri">https://engineering-shiny.org/index.html</a></p>
<div class="section level3">
<h3 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h3>
<p>First ensure you have access to the latest development tools and file
structure of the ReviewR package, fork ReviewR from GitHub. For
simplicity, the home directory is specified as a destination
directory:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages('usethis')</span></span>
<span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/create_from_github.html" class="external-link">create_from_github</a></span><span class="op">(</span>repo_spec <span class="op">=</span> <span class="st">'thewileylab/ReviewR'</span>, destdir <span class="op">=</span> <span class="st">'~/'</span><span class="op">)</span></span></code></pre></div>
<p>Please see <a href="https://happygitwithr.com" class="external-link">this guide</a> if you
have trouble connecting RStudio with Git. It is also possible to fork
this repository directly from GitHub if all else fails.</p>
<p><em>IMPORTANT:</em> If you think you would like to contribute data
model support to the ReviewR project, start a new branch to hold your
development work. However, if these changes are only for your own use or
for a custom data model that does not have widespread use cases, feel
free to perform your development work using the default branch.</p>
<p>Navigate to the forked repository and open the
<code>ReviewR.Rproj</code> file. This will open the project in RStudio.
Finally, using the devtools package run:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages('devtools')</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">load_all</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>You are now ready to begin the developing support for a new data
model.</p>
</div>
<div class="section level3">
<h3 id="required-information">Required Information<a class="anchor" aria-label="anchor" href="#required-information"></a>
</h3>
<p>To begin, either obtain or create a schema file for the data model
that you would like to support. As stated previously, this file must be
CSV formatted and contain two columns labeled <em>table</em> and
<em>field</em>. The contents of this file will be a pairwise combination
of every table/field in your target data model.</p>
</div>
<div class="section level3">
<h3 id="how-to-add-a-new-data-model">How to Add a New Data Model<a class="anchor" aria-label="anchor" href="#how-to-add-a-new-data-model"></a>
</h3>
<p>A convenience function has been built into ReviewR to assist with the
task of adding support for additional data models:
<code><a href="../reference/dev_add_data_model.html">dev_add_data_model()</a></code>.</p>
<p>This function is accepts a single argument, the path to a schema file
on your local machine. This function is intended for development
purposes, and as such, it must be run by appending 3 colons (:::) after
the package name, as in the following example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ReviewR</span><span class="fu">:::</span><span class="fu"><a href="../reference/dev_add_data_model.html">dev_add_data_model</a></span><span class="op">(</span>csv <span class="op">=</span> <span class="st">'path/to/schema/file.csv'</span><span class="op">)</span></span></code></pre></div>
<p>When run, this function will process the information stored in the
specified schema file and prompt you for some basic information
pertaining to the data model that you are attempting to add support for.
The first prompt that you will encounter is to identify which table
contains a listing of all patients. A listing of every table in the
schema file will be presented in the viewer pane of RStudio for you to
browse and locate the table containing the requested information. Enter
the number that corresponds to the correct table in the console and
press return to proceed.</p>
<p>Next, you will be asked which field contains the patient identifier
in the schema file. A listing of distinct fields will be presented in
the viewer pane. Locate the desired field and enter its numeric
representation into the console, followed by return.</p>
<p>At this point, the function has all of the information that it needs
to add very basic support for your data model to ReviewR. The schema
file will automatically be added to the list of supported data models
and a R file containing pre populated table functions will open with
some very basic table representations coded. At this point, you may want
to customize the representation for each table to your liking.</p>
<p>If your data model is simple, and each table stands on its own, ie.
it does not contain relational information, you are done! Save your
changes to the table function file and run:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">golem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/golem/man/document_and_reload.html" class="external-link">document_and_reload</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>To incorporate your new data model support into ReviewR.</p>
<p>If however your data model is relational, such as with OMOP (and
others) you may have additional work to do. It is important to note that
the <code>dev_add_data_model</code> function will create a skeleton
function for <em>every</em> table contained within your schema CSV file.
This is often not appropriate for relational databases, as certain
tables do not contain actual patient information, but rather hold
information about data stored in other tables.</p>
<p>In OMOP, this is seen most often with the concept table. The concept
table, on its own is likely not a table you’d like to display in
ReviewR, and would need to be manually removed from the resulting table
functions file as generated by <code>dev_add_data_model</code>. However,
almost every other table in the OMOP data model will require a join with
the concept table in order to access the patient information. Therefore,
table functions will need to be modified to make the appropriate joins
on the concept table. For example:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">omop_table_all_patients</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table_map</span>, <span class="va">db_connection</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/user_table.html">user_table</a></span><span class="op">(</span><span class="va">table_map</span>, <span class="va">db_connection</span>, <span class="st">'person'</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>ID <span class="op">=</span> <span class="fu"><a href="../reference/user_field.html">user_field</a></span><span class="op">(</span><span class="va">table_map</span>, <span class="st">'person'</span>, <span class="st">'person_id'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">left_join</span><span class="op">(</span><span class="fu"><a href="../reference/user_table.html">user_table</a></span><span class="op">(</span><span class="va">table_map</span>, <span class="va">db_connection</span>, <span class="st">'person'</span><span class="op">)</span>, </span>
<span>              by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="../reference/user_field.html">user_field</a></span><span class="op">(</span><span class="va">table_map</span>, <span class="st">'person'</span>, <span class="st">'gender_concept_id'</span><span class="op">)</span>, <span class="fu"><a href="../reference/user_field.html">user_field</a></span><span class="op">(</span><span class="va">table_map</span>, <span class="st">'concept'</span>, <span class="st">'concept_id'</span><span class="op">)</span><span class="op">)</span></span>
<span>              <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">collect</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The above will add the human readable representation of the subjects
gender to the ‘person’ table, rather than the numeric concept that is
stored in the “person” table. For additional information on the OMOP
data model, please consult the <a href="https://www.ohdsi.org/data-standardization/" class="external-link">OHDSI OMOP
website</a>.</p>
<p>When developing, it is important to be aware of these relationships
so that appropriate joins can be made to correctly the display the
information properly to the user. Tables which contain relational
information need not be displayed on the Chart Review Tab, and the table
function skeletons created by the dev function may safely be
removed.</p>
</div>
<div class="section level3">
<h3 id="developingtesting">Developing/Testing<a class="anchor" aria-label="anchor" href="#developingtesting"></a>
</h3>
<p>When making modifications to the template provided by
<code>dev_add_data_model</code>, feel free to <code>select()</code>,
<code><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter()</a></code>, <code>mutate()</code>, or otherwise modify the
appearance of the patient data such that it displays how you want it to
look on the Chart Review tab. The <code>dplyr</code> package has been
declared as an import in the table function skeleton, so that the many
<code>dplyr</code> manipulations may be included in your development.
Please leave the <code>collect()</code> part of the dplyr chain that has
been added, as data needs to be downloaded to ReviewR in order to be
displayed.</p>
<p>When you are ready to test these table functions within ReviewR,
run:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">golem</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/golem/man/document_and_reload.html" class="external-link">document_and_reload</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">ReviewR</span><span class="fu">::</span><span class="fu"><a href="../reference/run_app.html">run_app</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This will incorporate your newly developed functions into the active
R Session and launch the application so that you can connect to your
database and view your new data model within ReviewR. Remember, after
any change to the table functions you will have to run
<code><a href="https://rdrr.io/pkg/golem/man/document_and_reload.html" class="external-link">golem::document_and_reload()</a></code></p>
</div>
<div class="section level3">
<h3 id="finishing-up">Finishing up<a class="anchor" aria-label="anchor" href="#finishing-up"></a>
</h3>
<p>Once you are satisfied with your table functions and have
sufficiently tested their functionality, run:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This will install a new, custom version of the ReviewR package with
your newly incorporated data model and supporting table functions.</p>
<p>If you have developed support for an additional data model using this
vignette, and would like to contribute to the ReviewR project, we ask
that you please consider submitting your work as a pull request. Please
follow this excellent pull request guide if you would like to contribute
your modifications to the ReviewR package:</p>
<ul>
<li><a href="https://usethis.r-lib.org/articles/articles/pr-functions.html" class="external-link uri">https://usethis.r-lib.org/articles/articles/pr-functions.html</a></li>
</ul>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Laura Wiley, Luke Rasmussen, David Mayer, <a href="https://www.thewileylab.org/" class="external-link"><img src="https://raw.githubusercontent.com/thewileylab/ReviewR/master/man/figures/WileyLab.svg" height="24"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
